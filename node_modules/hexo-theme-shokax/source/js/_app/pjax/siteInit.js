"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const domInit_1 = __importDefault(require("./domInit"));
const refresh_1 = require("./refresh");
const scriptPjax_1 = require("../library/scriptPjax");
const search_1 = require("../page/search");
const globalVars_1 = require("../globals/globalVars");
const themeColor_1 = require("../globals/themeColor");
const handles_1 = require("../globals/handles");
const tools_1 = require("../globals/tools");
const fireworks_1 = require("../fireworks");
const theme_shokax_pjax_1 = __importDefault(require("theme-shokax-pjax"));
const vue_1 = require("../library/vue");
const siteInit = () => {
    (0, scriptPjax_1.cloudflareInit)();
    (0, domInit_1.default)();
    (0, vue_1.initVue)();
    (0, globalVars_1.setPjax)(new theme_shokax_pjax_1.default({
        selectors: [
            'head title',
            '.languages',
            '.twikoo',
            '.pjax',
            '.leancloud-recent-comment',
            'script[data-config]'
        ],
        cacheBust: false
    }));
    CONFIG.quicklink.ignores = LOCAL.ignores;
    quicklink.listen(CONFIG.quicklink);
    (0, themeColor_1.autoDarkmode)();
    if (!CONFIG.disableVL) {
        (0, handles_1.visibilityListener)();
    }
    (0, themeColor_1.themeColorListener)();
    (0, search_1.algoliaSearch)(globalVars_1.pjax);
    (0, fireworks_1.initFireworks)();
    window.addEventListener('scroll', handles_1.scrollHandle);
    window.addEventListener('resize', handles_1.resizeHandle);
    window.addEventListener('pjax:send', refresh_1.pjaxReload);
    window.addEventListener('pjax:success', refresh_1.siteRefresh);
    window.addEventListener('beforeunload', () => {
        (0, tools_1.pagePosition)();
    });
    (0, refresh_1.siteRefresh)(1);
};
window.addEventListener('DOMContentLoaded', siteInit, {
    passive: true
});
console.log('%c Theme.ShokaX v' + CONFIG.version + ' %c https://github.com/theme-shoka-x/hexo-theme-shokaX ', 'color: white; background: #e9546b; padding:5px 0;', 'padding:4px;border:1px solid #e9546b;');
